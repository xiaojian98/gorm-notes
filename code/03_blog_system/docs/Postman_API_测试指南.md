# åšå®¢ç³»ç»Ÿ Postman API æµ‹è¯•æŒ‡å— ğŸš€

## ğŸ“‹ ç›®å½•
- [å¯¼å…¥Postmané›†åˆ](#å¯¼å…¥postmané›†åˆ)
- [ç¯å¢ƒå˜é‡é…ç½®](#ç¯å¢ƒå˜é‡é…ç½®)
- [APIæµ‹è¯•æµç¨‹](#apiæµ‹è¯•æµç¨‹)
- [å¸¸è§æµ‹è¯•åœºæ™¯](#å¸¸è§æµ‹è¯•åœºæ™¯)
- [é”™è¯¯å¤„ç†è¯´æ˜](#é”™è¯¯å¤„ç†è¯´æ˜)
- [é«˜çº§æµ‹è¯•æŠ€å·§](#é«˜çº§æµ‹è¯•æŠ€å·§)

---

## ğŸ“¥ å¯¼å…¥Postmané›†åˆ

### 1. å¯¼å…¥é›†åˆæ–‡ä»¶
1. æ‰“å¼€ Postman åº”ç”¨
2. ç‚¹å‡»å·¦ä¸Šè§’ **Import** æŒ‰é’®
3. é€‰æ‹© **File** é€‰é¡¹å¡
4. ä¸Šä¼  `Blog_System_API.postman_collection.json` æ–‡ä»¶
5. ç‚¹å‡» **Import** å®Œæˆå¯¼å…¥

### 2. é›†åˆç»“æ„è¯´æ˜
å¯¼å…¥åæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹APIåˆ†ç»„ï¼š

```
ğŸ“ åšå®¢ç³»ç»Ÿ API æ¥å£é›†åˆ
â”œâ”€â”€ ğŸ¥ ç³»ç»Ÿå¥åº·æ£€æŸ¥
â”‚   â””â”€â”€ å¥åº·æ£€æŸ¥
â”œâ”€â”€ ğŸ‘¤ ç”¨æˆ·ç®¡ç†
â”‚   â”œâ”€â”€ ç”¨æˆ·æ³¨å†Œ
â”‚   â”œâ”€â”€ ç”¨æˆ·ç™»å½•
â”‚   â”œâ”€â”€ è·å–ç”¨æˆ·ä¿¡æ¯
â”‚   â””â”€â”€ æ›´æ–°ç”¨æˆ·èµ„æ–™
â”œâ”€â”€ ğŸ“ æ–‡ç« ç®¡ç†
â”‚   â”œâ”€â”€ è·å–æ–‡ç« åˆ—è¡¨
â”‚   â”œâ”€â”€ æ ¹æ®IDè·å–æ–‡ç« 
â”‚   â”œâ”€â”€ æ ¹æ®Slugè·å–æ–‡ç« 
â”‚   â”œâ”€â”€ åˆ›å»ºæ–‡ç« 
â”‚   â”œâ”€â”€ æ›´æ–°æ–‡ç« 
â”‚   â”œâ”€â”€ åˆ é™¤æ–‡ç« 
â”‚   â”œâ”€â”€ å‘å¸ƒæ–‡ç« 
â”‚   â”œâ”€â”€ ç‚¹èµæ–‡ç« 
â”‚   â””â”€â”€ å–æ¶ˆç‚¹èµæ–‡ç« 
â”œâ”€â”€ ğŸ’¬ è¯„è®ºç®¡ç†
â”‚   â”œâ”€â”€ è·å–æ–‡ç« è¯„è®º
â”‚   â”œâ”€â”€ åˆ›å»ºè¯„è®º
â”‚   â”œâ”€â”€ å›å¤è¯„è®º
â”‚   â”œâ”€â”€ å®¡æ ¸é€šè¿‡è¯„è®º
â”‚   â””â”€â”€ æ‹’ç»è¯„è®º
â”œâ”€â”€ ğŸ“‚ åˆ†ç±»ç®¡ç†
â”‚   â”œâ”€â”€ è·å–åˆ†ç±»åˆ—è¡¨
â”‚   â”œâ”€â”€ æ ¹æ®Slugè·å–åˆ†ç±»
â”‚   â””â”€â”€ åˆ›å»ºåˆ†ç±»
â”œâ”€â”€ ğŸ·ï¸ æ ‡ç­¾ç®¡ç†
â”‚   â”œâ”€â”€ è·å–æ ‡ç­¾åˆ—è¡¨
â”‚   â”œâ”€â”€ è·å–çƒ­é—¨æ ‡ç­¾
â”‚   â””â”€â”€ åˆ›å»ºæ ‡ç­¾
â”œâ”€â”€ ğŸ“Š ç»Ÿè®¡ä¿¡æ¯
â”‚   â”œâ”€â”€ è·å–ç»Ÿè®¡æ¦‚è§ˆ
â”‚   â””â”€â”€ è·å–çƒ­é—¨æ–‡ç« 
â””â”€â”€ ğŸ“– APIæ–‡æ¡£
    â””â”€â”€ è·å–APIæ–‡æ¡£
```

---

## âš™ï¸ ç¯å¢ƒå˜é‡é…ç½®

### 1. åˆ›å»ºç¯å¢ƒ
1. ç‚¹å‡»å³ä¸Šè§’çš„é½¿è½®å›¾æ ‡ âš™ï¸
2. é€‰æ‹© **Manage Environments**
3. ç‚¹å‡» **Add** åˆ›å»ºæ–°ç¯å¢ƒ
4. å‘½åä¸º `Blog System Local`

### 2. é…ç½®ç¯å¢ƒå˜é‡
æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

| å˜é‡å | åˆå§‹å€¼ | å½“å‰å€¼ | æè¿° |
|--------|--------|--------|------|
| `base_url` | `http://localhost:8080` | `http://localhost:8080` | APIåŸºç¡€URL |
| `user_id` | `1` | `1` | æµ‹è¯•ç”¨æˆ·ID |
| `post_id` | `1` | `1` | æµ‹è¯•æ–‡ç« ID |
| `post_slug` | `my-first-blog-post` | `my-first-blog-post` | æµ‹è¯•æ–‡ç« Slug |
| `comment_id` | `1` | `1` | æµ‹è¯•è¯„è®ºID |
| `category_slug` | `tech-share` | `tech-share` | æµ‹è¯•åˆ†ç±»Slug |
| `auth_token` | `` | `` | ç”¨æˆ·è®¤è¯Tokenï¼ˆç™»å½•åè·å–ï¼‰ |

### 3. æ¿€æ´»ç¯å¢ƒ
åœ¨å³ä¸Šè§’çš„ç¯å¢ƒä¸‹æ‹‰èœå•ä¸­é€‰æ‹© `Blog System Local`

---

## ğŸ§ª APIæµ‹è¯•æµç¨‹

### é˜¶æ®µ1: ç³»ç»Ÿæ£€æŸ¥ ğŸ¥

#### 1.1 å¥åº·æ£€æŸ¥
```http
GET {{base_url}}/health
```
**é¢„æœŸå“åº”**:
```json
{
  "status": "ok",
  "message": "Blog system is running"
}
```

### é˜¶æ®µ2: ç”¨æˆ·ç®¡ç† ğŸ‘¤

#### 2.1 ç”¨æˆ·æ³¨å†Œ
```http
POST {{base_url}}/api/users/register
Content-Type: application/json

{
  "username": "testuser",
  "email": "test@example.com",
  "password": "123456",
  "nickname": "æµ‹è¯•ç”¨æˆ·"
}
```

#### 2.2 ç”¨æˆ·ç™»å½•
```http
POST {{base_url}}/api/users/login
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "123456"
}
```
**é‡è¦**: ä¿å­˜å“åº”ä¸­çš„ `token` åˆ°ç¯å¢ƒå˜é‡ `auth_token`

#### 2.3 è·å–ç”¨æˆ·ä¿¡æ¯
```http
GET {{base_url}}/api/users/{{user_id}}
```

#### 2.4 æ›´æ–°ç”¨æˆ·èµ„æ–™
```http
PUT {{base_url}}/api/users/{{user_id}}/profile
Content-Type: application/json

{
  "bio": "è¿™æ˜¯æˆ‘çš„ä¸ªäººç®€ä»‹",
  "website": "https://example.com",
  "location": "åŒ—äº¬",
  "gender": "male"
}
```

### é˜¶æ®µ3: å†…å®¹ç®¡ç† ğŸ“

#### 3.1 åˆ›å»ºåˆ†ç±»
```http
POST {{base_url}}/api/categories
Content-Type: application/json

{
  "name": "æŠ€æœ¯åˆ†äº«",
  "slug": "tech-share",
  "description": "æŠ€æœ¯ç›¸å…³çš„æ–‡ç« åˆ†ç±»",
  "color": "#007bff",
  "icon": "tech",
  "sort_order": 1
}
```

#### 3.2 åˆ›å»ºæ ‡ç­¾
```http
POST {{base_url}}/api/tags
Content-Type: application/json

{
  "name": "Goè¯­è¨€",
  "slug": "golang",
  "color": "#00ADD8"
}
```

#### 3.3 åˆ›å»ºæ–‡ç« 
```http
POST {{base_url}}/api/posts
Content-Type: application/json

{
  "title": "æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« ",
  "content": "è¿™æ˜¯æ–‡ç« çš„è¯¦ç»†å†…å®¹ï¼Œæ”¯æŒMarkdownæ ¼å¼...",
  "excerpt": "è¿™æ˜¯æ–‡ç« æ‘˜è¦",
  "slug": "my-first-blog-post",
  "author_id": 1,
  "category_id": 1,
  "tags": [1, 2, 3],
  "status": "draft"
}
```

#### 3.4 å‘å¸ƒæ–‡ç« 
```http
POST {{base_url}}/api/posts/{{post_id}}/publish
```

#### 3.5 è·å–æ–‡ç« åˆ—è¡¨
```http
GET {{base_url}}/api/posts?page=1&limit=10&status=published
```

### é˜¶æ®µ4: äº’åŠ¨åŠŸèƒ½ ğŸ’¬

#### 4.1 å‘è¡¨è¯„è®º
```http
POST {{base_url}}/api/comments
Content-Type: application/json

{
  "content": "è¿™æ˜¯ä¸€æ¡è¯„è®ºå†…å®¹",
  "post_id": 1,
  "user_id": 1,
  "parent_id": null
}
```

#### 4.2 å›å¤è¯„è®º
```http
POST {{base_url}}/api/comments
Content-Type: application/json

{
  "content": "è¿™æ˜¯å¯¹è¯„è®ºçš„å›å¤",
  "post_id": 1,
  "user_id": 2,
  "parent_id": 1
}
```

#### 4.3 ç‚¹èµæ–‡ç« 
```http
POST {{base_url}}/api/posts/{{post_id}}/like
Content-Type: application/json

{
  "user_id": 1
}
```

---

## ğŸ¯ å¸¸è§æµ‹è¯•åœºæ™¯

### åœºæ™¯1: å®Œæ•´ç”¨æˆ·æµç¨‹æµ‹è¯•

```mermaid
flowchart TD
    A[å¥åº·æ£€æŸ¥] --> B[ç”¨æˆ·æ³¨å†Œ]
    B --> C[ç”¨æˆ·ç™»å½•]
    C --> D[åˆ›å»ºåˆ†ç±»]
    D --> E[åˆ›å»ºæ ‡ç­¾]
    E --> F[åˆ›å»ºæ–‡ç« ]
    F --> G[å‘å¸ƒæ–‡ç« ]
    G --> H[å‘è¡¨è¯„è®º]
    H --> I[ç‚¹èµæ–‡ç« ]
    I --> J[è·å–ç»Ÿè®¡ä¿¡æ¯]
    
    style A fill:#e1f5fe
    style B fill:#f3e5f5
    style C fill:#f3e5f5
    style D fill:#e8f5e8
    style E fill:#e8f5e8
    style F fill:#fff3e0
    style G fill:#fff3e0
    style H fill:#fce4ec
    style I fill:#fce4ec
    style J fill:#f1f8e9
```

**æ‰§è¡Œé¡ºåº**:
1. ğŸ¥ å¥åº·æ£€æŸ¥
2. ğŸ‘¤ ç”¨æˆ·æ³¨å†Œ â†’ ç”¨æˆ·ç™»å½•
3. ğŸ“‚ åˆ›å»ºåˆ†ç±»
4. ğŸ·ï¸ åˆ›å»ºæ ‡ç­¾
5. ğŸ“ åˆ›å»ºæ–‡ç«  â†’ å‘å¸ƒæ–‡ç« 
6. ğŸ’¬ å‘è¡¨è¯„è®º
7. â¤ï¸ ç‚¹èµæ–‡ç« 
8. ğŸ“Š è·å–ç»Ÿè®¡ä¿¡æ¯

### åœºæ™¯2: è¯„è®ºç³»ç»Ÿæµ‹è¯•

```mermaid
flowchart TD
    A[åˆ›å»ºæ–‡ç« ] --> B[å‘è¡¨é¡¶çº§è¯„è®º]
    B --> C[å›å¤è¯„è®º]
    C --> D[å®¡æ ¸è¯„è®º]
    D --> E[è·å–æ–‡ç« è¯„è®º]
    
    style A fill:#fff3e0
    style B fill:#fce4ec
    style C fill:#fce4ec
    style D fill:#e8f5e8
    style E fill:#f1f8e9
```

### åœºæ™¯3: æ–‡ç« ç”Ÿå‘½å‘¨æœŸæµ‹è¯•

```mermaid
stateDiagram-v2
    [*] --> è‰ç¨¿: åˆ›å»ºæ–‡ç« 
    è‰ç¨¿ --> å·²å‘å¸ƒ: å‘å¸ƒæ–‡ç« 
    å·²å‘å¸ƒ --> å·²å½’æ¡£: å½’æ¡£æ–‡ç« 
    å·²å½’æ¡£ --> å·²å‘å¸ƒ: é‡æ–°å‘å¸ƒ
    å·²å‘å¸ƒ --> [*]: åˆ é™¤æ–‡ç« 
    
    è‰ç¨¿ : status = 'draft'
    å·²å‘å¸ƒ : status = 'published'
    å·²å½’æ¡£ : status = 'archived'
```

---

## âŒ é”™è¯¯å¤„ç†è¯´æ˜

### å¸¸è§HTTPçŠ¶æ€ç 

| çŠ¶æ€ç  | å«ä¹‰ | å¸¸è§åŸå›  | è§£å†³æ–¹æ¡ˆ |
|--------|------|----------|----------|
| `200` | æˆåŠŸ | è¯·æ±‚å¤„ç†æˆåŠŸ | - |
| `201` | åˆ›å»ºæˆåŠŸ | èµ„æºåˆ›å»ºæˆåŠŸ | - |
| `400` | è¯·æ±‚é”™è¯¯ | å‚æ•°éªŒè¯å¤±è´¥ | æ£€æŸ¥è¯·æ±‚å‚æ•°æ ¼å¼å’Œå¿…å¡«å­—æ®µ |
| `401` | æœªæˆæƒ | è®¤è¯å¤±è´¥ | æ£€æŸ¥Tokenæ˜¯å¦æœ‰æ•ˆ |
| `404` | èµ„æºä¸å­˜åœ¨ | è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨ | æ£€æŸ¥IDæˆ–Slugæ˜¯å¦æ­£ç¡® |
| `409` | å†²çª | èµ„æºå·²å­˜åœ¨ | æ£€æŸ¥å”¯ä¸€æ€§å­—æ®µï¼ˆå¦‚ç”¨æˆ·åã€é‚®ç®±ï¼‰ |
| `500` | æœåŠ¡å™¨é”™è¯¯ | å†…éƒ¨æœåŠ¡å™¨é”™è¯¯ | æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿— |

### å…¸å‹é”™è¯¯å“åº”æ ¼å¼

```json
{
  "error": "ç”¨æˆ·åæˆ–é‚®ç®±å·²å­˜åœ¨"
}
```

### å‚æ•°éªŒè¯é”™è¯¯ç¤ºä¾‹

```json
{
  "error": "Key: 'User.Username' Error:Field validation for 'Username' failed on the 'required' tag"
}
```

---

## ğŸ”§ é«˜çº§æµ‹è¯•æŠ€å·§

### 1. ä½¿ç”¨Pre-request Scripts

åœ¨è¯·æ±‚å‰è‡ªåŠ¨è®¾ç½®å˜é‡ï¼š

```javascript
// ç”Ÿæˆéšæœºç”¨æˆ·å
pm.environment.set("random_username", "user_" + Math.random().toString(36).substr(2, 9));

// ç”Ÿæˆéšæœºé‚®ç®±
pm.environment.set("random_email", "test_" + Math.random().toString(36).substr(2, 9) + "@example.com");

// è®¾ç½®å½“å‰æ—¶é—´æˆ³
pm.environment.set("timestamp", new Date().getTime());
```

### 2. ä½¿ç”¨Testsè„šæœ¬

è‡ªåŠ¨éªŒè¯å“åº”å’Œæå–æ•°æ®ï¼š

```javascript
// éªŒè¯çŠ¶æ€ç 
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

// éªŒè¯å“åº”æ—¶é—´
pm.test("Response time is less than 200ms", function () {
    pm.expect(pm.response.responseTime).to.be.below(200);
});

// æå–ç”¨æˆ·ID
if (pm.response.code === 201) {
    const responseJson = pm.response.json();
    pm.environment.set("user_id", responseJson.user.id);
}

// æå–è®¤è¯Token
if (pm.response.code === 200) {
    const responseJson = pm.response.json();
    if (responseJson.token) {
        pm.environment.set("auth_token", responseJson.token);
    }
}
```

### 3. æ‰¹é‡æµ‹è¯•è¿è¡Œ

#### ä½¿ç”¨Collection Runner
1. ç‚¹å‡»é›†åˆå³ä¾§çš„ **â–¶ï¸** æŒ‰é’®
2. é€‰æ‹©è¦è¿è¡Œçš„è¯·æ±‚
3. è®¾ç½®è¿­ä»£æ¬¡æ•°å’Œå»¶è¿Ÿ
4. ç‚¹å‡» **Run** å¼€å§‹æ‰¹é‡æµ‹è¯•

#### ä½¿ç”¨Newmanå‘½ä»¤è¡Œ
```bash
# å®‰è£…Newman
npm install -g newman

# è¿è¡Œæµ‹è¯•é›†åˆ
newman run Blog_System_API.postman_collection.json \
  --environment Blog_System_Local.postman_environment.json \
  --reporters html,cli \
  --reporter-html-export report.html
```

### 4. æ•°æ®é©±åŠ¨æµ‹è¯•

åˆ›å»ºCSVæ–‡ä»¶ `test_data.csv`ï¼š
```csv
username,email,password
testuser1,test1@example.com,123456
testuser2,test2@example.com,123456
testuser3,test3@example.com,123456
```

åœ¨Collection Runnerä¸­ä¸Šä¼ CSVæ–‡ä»¶è¿›è¡Œæ‰¹é‡æµ‹è¯•ã€‚

---

## ğŸ“Š æµ‹è¯•æŠ¥å‘Š

### ç”ŸæˆHTMLæŠ¥å‘Š

ä½¿ç”¨Newmanç”Ÿæˆè¯¦ç»†çš„HTMLæµ‹è¯•æŠ¥å‘Šï¼š

```bash
newman run Blog_System_API.postman_collection.json \
  --environment Blog_System_Local.postman_environment.json \
  --reporters htmlextra \
  --reporter-htmlextra-export report.html \
  --reporter-htmlextra-darkTheme
```

### é›†æˆCI/CD

åœ¨GitHub Actionsä¸­é›†æˆAPIæµ‹è¯•ï¼š

```yaml
name: API Tests
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Install Newman
        run: npm install -g newman
      - name: Run API Tests
        run: |
          newman run docs/Blog_System_API.postman_collection.json \
            --reporters cli,junit \
            --reporter-junit-export results.xml
      - name: Publish Test Results
        uses: EnricoMi/publish-unit-test-result-action@v1
        if: always()
        with:
          files: results.xml
```

---

## ğŸ‰ æ€»ç»“

é€šè¿‡è¿™ä¸ªPostmané›†åˆï¼Œæ‚¨å¯ä»¥ï¼š

âœ… **å®Œæ•´æµ‹è¯•åšå®¢ç³»ç»Ÿçš„æ‰€æœ‰APIæ¥å£**  
âœ… **éªŒè¯ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€æ–‡ç« ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½**  
âœ… **æµ‹è¯•è¯„è®ºç³»ç»Ÿå’Œç‚¹èµåŠŸèƒ½**  
âœ… **éªŒè¯æ•°æ®åº“å…³ç³»å’Œçº¦æŸ**  
âœ… **è¿›è¡Œæ€§èƒ½å’Œå‹åŠ›æµ‹è¯•**  
âœ… **ç”Ÿæˆè¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Š**  

### å¿«é€Ÿå¼€å§‹æ­¥éª¤
1. ğŸš€ å¯åŠ¨åšå®¢ç³»ç»ŸæœåŠ¡ (`go run main.go`)
2. ğŸ“¥ å¯¼å…¥Postmané›†åˆæ–‡ä»¶
3. âš™ï¸ é…ç½®ç¯å¢ƒå˜é‡
4. ğŸ§ª æŒ‰ç…§æµ‹è¯•æµç¨‹æ‰§è¡ŒAPIè°ƒç”¨
5. ğŸ“Š æŸ¥çœ‹æµ‹è¯•ç»“æœå’Œå“åº”æ•°æ®

ç¥æ‚¨æµ‹è¯•æ„‰å¿«ï¼ğŸŠ